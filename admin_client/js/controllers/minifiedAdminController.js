angular.module("rikeAppCategoryController",["rikeAppService","ngAnimate","mgcrea.ngStrap"]).controller("CategoryCtrl",["$scope","$resource","CategoryService",function(e,o,r){e.categories=[],r.get(function(o){e.categories=o}),e.popover={},e.addCategory=function(o){r.add(o,function(o){o.tooManyCatsMessage?e.popover={title:"Achtung",content:"Maximal 8 Kategorien"}:(e.categories.push(o),e.cat="",delete e.popover)})};var t=o("/api/cat/:id");e.delCategory=function(o){var a=new t({_id:o._id});a.$remove({id:o._id},function(t,a){var n=e.categories.indexOf(o);n>-1&&(r.remove(o),e.categories.splice(n,1))})}}]);var appController=angular.module("rikeAppHomeController",[]);appController.controller("MainController",["$scope","$location",function(e,o){e.isActive=function(e){return e===o.path()},e.css="//maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap.min.css",e.bootstraps=[{name:"Basic",url:"//maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap.min.css"},{name:"Cosmo",url:"//maxcdn.bootstrapcdn.com/bootswatch/3.3.2/cosmo/bootstrap.min.css"},{name:"Flatly",url:"//maxcdn.bootstrapcdn.com/bootswatch/3.3.2/flatly/bootstrap.min.css"},{name:"Journal",url:"//maxcdn.bootstrapcdn.com/bootswatch/3.3.2/journal/bootstrap.min.css"},{name:"Paper",url:"//maxcdn.bootstrapcdn.com/bootswatch/3.3.2/paper/bootstrap.min.css"},{name:"Yeti",url:"//maxcdn.bootstrapcdn.com/bootswatch/3.3.2/yeti/bootstrap.min.css"}]}]),appController.controller("HomeCtrl",["$scope",function(e){e.name="Rike"}]),angular.module("rikeAppPictureController",["rikeAppService"]).controller("PictureCtrl",["$scope","$resource",function(e,o){e.loader={loading:!0};var r=o("/api/pics");r.query(function(o){e.pictures=o,e.loader.loading=!1}),e.pictures=[];var t=o("/api/pics/:id");e.delPicture=function(o){var r=new t({_id:o._id});r.$remove({id:o._id},function(r,t){var a=e.pictures.indexOf(o);a>-1&&e.pictures.splice(a,1)})},e.delAllPictures=function(){for(var o=0;o<e.pictures.length;o++){var r=e.pictures[o],a=new t({_id:r._id});a.$remove({id:r._id},function(e,o){e&&console.log(e)})}e.pictures=[]}}]),angular.module("rikeAppSubcategoryController",["rikeAppService","ngAnimate","mgcrea.ngStrap"]).controller("SubcategoryCtrl",["$scope","$resource","SubcategoryService","$routeParams",function(e,o,r,t){e.ubercategory=t.sub,e.subcategories=[],r.get(e.ubercategory,function(o){e.subcategories=o}),e.popover={},e.addCategory=function(o,t){console.log(t),r.add(o,t,function(o){o.tooManyCatsMessage?e.popover={title:"Achtung",content:"Maximal 8 Unterkategorien"}:(e.subcategories.push(o),e.cat="subcat",delete e.popover)})};var a=o("/api/cat/subs/:id");e.delCategory=function(o){var t=new a({_id:o._id});t.$remove({id:o._id},function(t,a){var n=e.subcategories.indexOf(o);n>-1&&(r.remove(o),e.subcategories.splice(n,1))})}}]),angular.module("rikeAppUploadController",["rikeAppService"]).controller("UploadCtrl",["$scope","$upload","$resource","FileService","CategoryService",function(e,o,r,t,a){var n=[];a.get(function(o){n=o,e.categoryOptions=[{name:"0",value:""}];for(var r=0;r<n.length;r++)e.categoryOptions.push({name:r+1,value:n[r].value});e.category=e.categoryOptions[0]}),e.$watch("files",function(){e.upload(e.files)}),e.pics=t.get(),e.upload=function(r){if(r&&r.length){e.loader={loading:!1,progress:0};for(var a=0;a<r.length;a++){var n=r[a];e.loader.loading=!0,o.upload({url:"/api/pics/upload",fields:{category:e.category.value},file:n}).progress(function(o){var r=parseInt(100*o.loaded/o.total);e.loader.progress=r}).success(function(o,r,a,n){var c=o.file[0].path.replace(/\\/g,"/");c=c.split("/"),c=c[c.length-1],t.add(c,"",e.category.value),e.loader.loading=!1})}}};var c=r("/api/pics");e.addPictures=function(){for(var o=0;o<e.pics.length;o++){var r=new c;r.caption=e.pics[o].caption,r.url=e.pics[o].filename,r.category=e.pics[o].category,r.$save(function(e){t.remove(r.url)})}},e.delPicture=function(e){console.log("Deleting: "+e),t.remove(e.filename),t["delete"](e.filename)},e.addPicture=function(o){console.log("Adding: "+o.filename);var r=e.pics.indexOf(o);r>-1&&e.pics.splice(r,1);var a=new c;a.caption=o.caption,a.url=o.filename,a.category=o.category,a.$save(function(e){t.remove(a.url)})}}]);